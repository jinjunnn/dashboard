---
description:
globs:
alwaysApply: false
---
# åç«¯æ¥å£æ–‡æ¡£

## ğŸ“‹ æ¥å£æ¦‚è§ˆ

æœ¬æ–‡æ¡£è®°å½•é¡¹ç›®ä¸­æ‰€æœ‰åç«¯æ¥å£çš„ç®€è¦ä¿¡æ¯ï¼Œä¾›AI Agentå‚è€ƒä½¿ç”¨ã€‚æ¯æ¬¡æ–°å¢æˆ–å˜æ›´æ¥å£æ—¶éƒ½éœ€è¦æ›´æ–°æ­¤æ–‡æ¡£ã€‚

## ğŸ—„ï¸ Supabase æ•°æ®åº“æ¥å£

### ä¿¡å·æŸ¥è¯¢æ¥å£

#### `getSignals(category, signalName?)`
- **åŠŸèƒ½**: è·å–äº¤æ˜“ä¿¡å·åˆ—è¡¨ï¼ˆæ”¯æŒé…ç½®é©±åŠ¨ï¼‰
- **å‚æ•°**: 
  - `category`: 'intraday' | 'daily'
  - `signalName?`: å¯é€‰ï¼Œç‰¹å®šä¿¡å·ç±»å‹åç§°
- **è¿”å›**: Signal[] æ•°ç»„
- **ç‰¹ç‚¹**: åŸºäºsignals-config.tsé…ç½®ï¼Œåªè¿”å›å¯ç”¨çš„ä¿¡å·ç±»å‹

#### `getSignalsByConfigId(configId)`
- **åŠŸèƒ½**: æ ¹æ®ä¿¡å·é…ç½®IDæŸ¥è¯¢ä¿¡å·
- **å‚æ•°**: `configId` - ä¿¡å·é…ç½®ID
- **è¿”å›**: Signal[] æ•°ç»„
- **ç‰¹ç‚¹**: åŒ…å«é…ç½®éªŒè¯å’Œé”™è¯¯å¤„ç†

#### `getSignalStats(category)`
- **åŠŸèƒ½**: è·å–ä¿¡å·ç»Ÿè®¡ä¿¡æ¯
- **å‚æ•°**: `category` - 'intraday' | 'daily'
- **è¿”å›**: ä¿¡å·é…ç½® + æ•°é‡ç»Ÿè®¡
- **ç‰¹ç‚¹**: è¿”å›æ¯ä¸ªä¿¡å·ç±»å‹çš„æ•°é‡ç»Ÿè®¡

### ç”¨æˆ·ç®¡ç†æ¥å£

#### `getUserProfile(userId)`
- **åŠŸèƒ½**: è·å–ç”¨æˆ·é…ç½®ä¿¡æ¯
- **å‚æ•°**: `userId` - ç”¨æˆ·ID
- **è¿”å›**: UserProfile å¯¹è±¡
- **ç‰¹ç‚¹**: åŒ…å«ç”¨æˆ·ç­‰çº§å’Œè°ƒç”¨æ¬¡æ•°é™åˆ¶

#### `updateUserCalls(userId, type)`
- **åŠŸèƒ½**: æ›´æ–°ç”¨æˆ·è°ƒç”¨æ¬¡æ•°
- **å‚æ•°**: 
  - `userId` - ç”¨æˆ·ID
  - `type` - 'intraday' | 'daily'
- **è¿”å›**: æ›´æ–°ç»“æœ
- **ç‰¹ç‚¹**: è‡ªåŠ¨é€’å¢è°ƒç”¨æ¬¡æ•°

#### `checkUserPermission(userId, action)`
- **åŠŸèƒ½**: æ£€æŸ¥ç”¨æˆ·æƒé™
- **å‚æ•°**: 
  - `userId` - ç”¨æˆ·ID
  - `action` - æ“ä½œç±»å‹
- **è¿”å›**: æƒé™æ£€æŸ¥ç»“æœ
- **ç‰¹ç‚¹**: åŸºäºç”¨æˆ·ç­‰çº§çš„é™åˆ¶æ£€æŸ¥

## ğŸ“Š æ•°æ®ç»“æ„

### Signal æ¥å£
```typescript
interface Signal {
  id: number
  symbol: string
  signal_type: string
  category: 'intraday' | 'daily'
  direction: 'BULLISH' | 'BEARISH'
  price: number
  confidence: number
  status: string
  created_at: string
  expires_at: string
  meta_data: Record<string, any>
  backtest?: BacktestData
}
```

### UserProfile æ¥å£
```typescript
interface UserProfile {
  id: string
  tier: 'free' | 'pro' | 'premium'
  intraday_calls_today: number
  daily_calls_today: number
  last_reset: string
  created_at: string
}
```

## ğŸ”„ æ›´æ–°è§„åˆ™

1. **æ–°å¢æ¥å£** - æ·»åŠ æ¥å£åç§°ã€åŠŸèƒ½ã€å‚æ•°ã€è¿”å›å€¼è¯´æ˜
2. **ä¿®æ”¹æ¥å£** - æ›´æ–°å¯¹åº”æ¥å£çš„å‚æ•°æˆ–è¿”å›å€¼è¯´æ˜
3. **åˆ é™¤æ¥å£** - ç§»é™¤å¯¹åº”æ¥å£ä¿¡æ¯å¹¶åœ¨changelogä¸­è®°å½•
4. **æ•°æ®ç»“æ„å˜æ›´** - åŒæ­¥æ›´æ–°ç›¸å…³æ¥å£çš„æ•°æ®ç»“æ„è¯´æ˜

### é…ç½®ç›¸å…³æ¥å£

#### `getSignalsByCategory(category)`
- **åŠŸèƒ½**: æ ¹æ®ç±»åˆ«è·å–ä¿¡å·é…ç½®åˆ—è¡¨
- **å‚æ•°**: `category` - 'intraday' | 'daily'
- **è¿”å›**: SignalConfig[] æ•°ç»„
- **ç‰¹ç‚¹**: ä»signals-config.tsé…ç½®æ–‡ä»¶è·å–

#### `getSignalByName(name)`
- **åŠŸèƒ½**: æ ¹æ®ä¿¡å·åç§°è·å–é…ç½®
- **å‚æ•°**: `name` - ä¿¡å·ç±»å‹åç§°
- **è¿”å›**: SignalConfig | undefined
- **ç‰¹ç‚¹**: æ”¯æŒé…ç½®éªŒè¯å’Œé”™è¯¯å¤„ç†

#### `getSignalConfigById(configId)`
- **åŠŸèƒ½**: æ ¹æ®é…ç½®IDè·å–ä¿¡å·é…ç½®
- **å‚æ•°**: `configId` - ä¿¡å·é…ç½®ID
- **è¿”å›**: SignalConfig | undefined
- **ç‰¹ç‚¹**: ç”¨äºé…ç½®é©±åŠ¨çš„ä¿¡å·æŸ¥è¯¢

### æœåŠ¡å±‚æ¥å£

#### `searchSignals(searchTerm, category?)`
- **åŠŸèƒ½**: æœç´¢ä¿¡å·ï¼ˆæ”¯æŒè‚¡ç¥¨ä»£ç å’Œåç§°ï¼‰
- **å‚æ•°**: 
  - `searchTerm` - æœç´¢å…³é”®è¯
  - `category?` - å¯é€‰ï¼Œä¿¡å·ç±»åˆ«
- **è¿”å›**: Signal[] æ•°ç»„
- **ç‰¹ç‚¹**: æ”¯æŒæ¨¡ç³Šæœç´¢å’Œåˆ†ç±»ç­›é€‰

## ğŸ“ ç»´æŠ¤è¯´æ˜

- æ­¤æ–‡æ¡£ä»…è®°å½•æ¥å£çš„åŸºæœ¬ä¿¡æ¯ï¼Œè¯¦ç»†å®ç°è¯·å‚è€ƒ `backend_api.mdc`
- æ¯æ¬¡æ¥å£å˜æ›´éƒ½å¿…é¡»åŒæ—¶æ›´æ–°æ­¤æ–‡æ¡£å’Œchangelog.md
- æ¥å£å‘½ååº”ä¿æŒä¸€è‡´æ€§å’Œè¯­ä¹‰åŒ–
- é…ç½®ç›¸å…³æ¥å£ä¸»è¦æ¥è‡ª `signals-config.ts` é…ç½®æ–‡ä»¶
- æœåŠ¡å±‚æ¥å£ä½äº `src/lib/services/signals-service.ts`
