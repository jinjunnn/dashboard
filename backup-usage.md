# é¡¹ç›®å¤‡ä»½è„šæœ¬ä½¿ç”¨è¯´æ˜

æœ¬é¡¹ç›®åŒ…å«ä¸‰ä¸ªç”¨äºæœ¬åœ°é¡¹ç›®çŠ¶æ€ç®¡ç†çš„è„šæœ¬ï¼Œå¯ä»¥å¿«é€Ÿä¿å­˜å’Œæ¢å¤é¡¹ç›®çŠ¶æ€ã€‚

## ğŸ“‹ è„šæœ¬æ–‡ä»¶

- `save-state.sh` - ä¿å­˜å½“å‰é¡¹ç›®çŠ¶æ€
- `restore-state.sh` - æ¢å¤é¡¹ç›®çŠ¶æ€  
- `manage-backups.sh` - ç®¡ç†å¤‡ä»½æ–‡ä»¶

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ä¿å­˜å½“å‰çŠ¶æ€

```bash
# è‡ªåŠ¨ç”Ÿæˆå¤‡ä»½åç§°ï¼ˆä½¿ç”¨æ—¶é—´æˆ³ï¼‰
./save-state.sh

# ä½¿ç”¨è‡ªå®šä¹‰å¤‡ä»½åç§°
./save-state.sh "stable-version"
./save-state.sh "before-refactor"
./save-state.sh "working-state"
```

### 2. æŸ¥çœ‹æ‰€æœ‰å¤‡ä»½

```bash
# åˆ—å‡ºæ‰€æœ‰å¯ç”¨å¤‡ä»½
./manage-backups.sh list

# æˆ–ç›´æ¥è¿è¡Œæ¢å¤è„šæœ¬æŸ¥çœ‹
./restore-state.sh
```

### 3. æ¢å¤åˆ°æŸä¸ªçŠ¶æ€

```bash
# æ¢å¤åˆ°æŒ‡å®šå¤‡ä»½
./restore-state.sh "stable-version"
./restore-state.sh "backup_20241208_143022"
```

### 4. ç®¡ç†å¤‡ä»½

```bash
# æ¸…ç†æ—§å¤‡ä»½ï¼ˆä¿ç•™æœ€è¿‘5ä¸ªï¼‰
./manage-backups.sh clean

# åˆ é™¤ç‰¹å®šå¤‡ä»½
./manage-backups.sh delete "old-backup"

# æŸ¥çœ‹å¸®åŠ©
./manage-backups.sh help
```

## ğŸ“– è¯¦ç»†è¯´æ˜

### save-state.sh

**åŠŸèƒ½**: ä¿å­˜å½“å‰é¡¹ç›®çŠ¶æ€åˆ°æœ¬åœ°gitä»“åº“

**ç‰¹æ€§**:
- è‡ªåŠ¨æ£€æµ‹å¹¶æäº¤æœªæš‚å­˜çš„æ›´æ”¹
- åˆ›å»ºå¤‡ä»½åˆ†æ”¯å’Œæ ‡ç­¾
- æ”¯æŒè‡ªå®šä¹‰å¤‡ä»½åç§°
- å½©è‰²è¾“å‡ºï¼Œæ¸…æ™°çš„çŠ¶æ€åé¦ˆ

**ä½¿ç”¨åœºæ™¯**:
- å¼€å§‹æ–°åŠŸèƒ½å¼€å‘å‰
- é‡å¤§é‡æ„å‰
- æµ‹è¯•æ–°åŠŸèƒ½å‰
- ä»»ä½•ä¸ç¡®å®šçš„ä»£ç ä¿®æ”¹å‰

### restore-state.sh

**åŠŸèƒ½**: æ¢å¤åˆ°ä¹‹å‰ä¿å­˜çš„é¡¹ç›®çŠ¶æ€

**ç‰¹æ€§**:
- åˆ—å‡ºæ‰€æœ‰å¯ç”¨å¤‡ä»½
- å®‰å…¨æ£€æŸ¥å½“å‰å·¥ä½œåŒºçŠ¶æ€
- è‡ªåŠ¨åˆ›å»ºæ¢å¤åˆ†æ”¯ï¼Œä¸å½±å“åŸåˆ†æ”¯
- æ”¯æŒä»å¤‡ä»½åˆ†æ”¯æˆ–æ ‡ç­¾æ¢å¤

**å®‰å…¨æœºåˆ¶**:
- å¦‚æœå·¥ä½œåŒºæœ‰æœªæäº¤æ›´æ”¹ï¼Œæä¾›é€‰é¡¹ï¼š
  1. ä¿å­˜å½“å‰æ›´æ”¹å¹¶ç»§ç»­æ¢å¤
  2. ä¸¢å¼ƒå½“å‰æ›´æ”¹å¹¶ç»§ç»­æ¢å¤
  3. å–æ¶ˆæ¢å¤æ“ä½œ

### manage-backups.sh

**åŠŸèƒ½**: ç®¡ç†æœ¬åœ°å¤‡ä»½æ–‡ä»¶

**å‘½ä»¤**:
- `list` - æ˜¾ç¤ºæ‰€æœ‰å¤‡ä»½åŠå…¶åˆ›å»ºæ—¶é—´
- `clean` - æ¸…ç†æ—§å¤‡ä»½ï¼ˆä¿ç•™æœ€è¿‘5ä¸ªï¼‰
- `delete <name>` - åˆ é™¤æŒ‡å®šå¤‡ä»½
- `help` - æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯

## ğŸ¯ æœ€ä½³å®è·µ

### 1. å¤‡ä»½æ—¶æœº
```bash
# å¼€å§‹æ–°åŠŸèƒ½å‰
./save-state.sh "before-feature-authentication"

# é‡æ„ä»£ç å‰
./save-state.sh "before-refactor-$(date +%Y%m%d)"

# æµ‹è¯•å±é™©æ“ä½œå‰
./save-state.sh "stable-working-state"
```

### 2. å‘½åè§„èŒƒ
å»ºè®®ä½¿ç”¨æè¿°æ€§çš„å¤‡ä»½åç§°ï¼š
- `stable-v1.0` - ç¨³å®šç‰ˆæœ¬
- `before-database-migration` - æ•°æ®åº“è¿ç§»å‰
- `working-signals-feature` - ä¿¡å·åŠŸèƒ½å·¥ä½œç‰ˆæœ¬
- `backup-$(date +%Y%m%d)` - æ—¥æœŸå¤‡ä»½

### 3. å®šæœŸæ¸…ç†
```bash
# æ¯å‘¨æ¸…ç†ä¸€æ¬¡æ—§å¤‡ä»½
./manage-backups.sh clean
```

### 4. æ¢å¤å·¥ä½œæµ
```bash
# 1. æŸ¥çœ‹å¯ç”¨å¤‡ä»½
./restore-state.sh

# 2. æ¢å¤åˆ°ç›®æ ‡çŠ¶æ€
./restore-state.sh "stable-version"

# 3. æ£€æŸ¥æ¢å¤ç»“æœ
git log --oneline -5

# 4. å¦‚æœæ»¡æ„ï¼Œåˆå¹¶åˆ°ä¸»åˆ†æ”¯
git checkout main
git merge restored-from-stable-version-20241208_143022

# 5. æ¸…ç†æ¢å¤åˆ†æ”¯
git branch -d restored-from-stable-version-20241208_143022
```

## ğŸ“‚ å¤‡ä»½å­˜å‚¨ç»“æ„

```
.git/
â”œâ”€â”€ refs/heads/
â”‚   â”œâ”€â”€ main                    # ä¸»åˆ†æ”¯
â”‚   â”œâ”€â”€ backup/stable-v1.0      # å¤‡ä»½åˆ†æ”¯
â”‚   â”œâ”€â”€ backup/before-refactor  # å¤‡ä»½åˆ†æ”¯
â”‚   â””â”€â”€ restored-from-*         # æ¢å¤åˆ†æ”¯ï¼ˆä¸´æ—¶ï¼‰
â””â”€â”€ refs/tags/
    â”œâ”€â”€ save-stable-v1.0        # å¤‡ä»½æ ‡ç­¾
    â””â”€â”€ save-before-refactor    # å¤‡ä»½æ ‡ç­¾
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä»…æœ¬åœ°å¤‡ä»½**: è¿™äº›è„šæœ¬åªåœ¨æœ¬åœ°gitä»“åº“ä¸­åˆ›å»ºå¤‡ä»½ï¼Œä¸ä¼šæ¨é€åˆ°è¿œç¨‹ä»“åº“
2. **å·¥ä½œåŒºæ£€æŸ¥**: æ¢å¤å‰ä¼šæ£€æŸ¥å·¥ä½œåŒºçŠ¶æ€ï¼Œç¡®ä¿ä¸ä¸¢å¤±æœªæäº¤çš„æ›´æ”¹
3. **åˆ†æ”¯ç®¡ç†**: æ¢å¤æ“ä½œä¼šåˆ›å»ºæ–°åˆ†æ”¯ï¼Œéœ€è¦æ‰‹åŠ¨åˆå¹¶åˆ°ç›®æ ‡åˆ†æ”¯
4. **å­˜å‚¨ç©ºé—´**: å®šæœŸä½¿ç”¨ `./manage-backups.sh clean` æ¸…ç†æ—§å¤‡ä»½

## ğŸ†˜ æ•…éšœæ’é™¤

### é—®é¢˜1: è„šæœ¬æ²¡æœ‰æ‰§è¡Œæƒé™
```bash
chmod +x save-state.sh restore-state.sh manage-backups.sh
```

### é—®é¢˜2: ä¸åœ¨gitä»“åº“ä¸­
ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œè„šæœ¬ï¼Œä¸”è¯¥ç›®å½•æ˜¯gitä»“åº“ã€‚

### é—®é¢˜3: æ¢å¤åä»£ç ä¸æ˜¯æœŸæœ›çš„çŠ¶æ€
```bash
# æŸ¥çœ‹å½“å‰åˆ†æ”¯çš„æäº¤å†å²
git log --oneline -10

# æŸ¥çœ‹æ‰€æœ‰å¤‡ä»½
./manage-backups.sh list

# å°è¯•æ¢å¤åˆ°å…¶ä»–å¤‡ä»½
./restore-state.sh "other-backup-name"
```

### é—®é¢˜4: å¤‡ä»½åˆ†æ”¯æˆ–æ ‡ç­¾å·²å­˜åœ¨
è„šæœ¬ä¼šè‡ªåŠ¨å¤„ç†é‡åæƒ…å†µï¼Œåˆ é™¤æ—§çš„å¤‡ä»½å¹¶åˆ›å»ºæ–°çš„ã€‚

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š
1. æŸ¥çœ‹è„šæœ¬çš„è¯¦ç»†è¾“å‡ºä¿¡æ¯
2. è¿è¡Œ `git status` æ£€æŸ¥ä»“åº“çŠ¶æ€
3. è¿è¡Œ `./manage-backups.sh list` æŸ¥çœ‹å¤‡ä»½çŠ¶æ€ 